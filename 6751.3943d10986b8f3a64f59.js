(self.webpackChunkMyInnovak=self.webpackChunkMyInnovak||[]).push([[6751],{6751:(e,n,t)=>{"use strict";t.r(n),t.d(n,{HttpLoaderFactory:()=>Z,NewMileagePageModule:()=>p});var i=t(1116),o=t(1041),a=t(4812),r=t(4258),s=t(4762),l=t(5366),g=t(6171),d=t(7047),u=t(649),c=t(4216);const h=[{path:"",component:(()=>{class e{constructor(e,n,t,i,o,a,r,s){this.datePipe=e,this.loadingCtrl=n,this.alertCtrl=t,this.expensesService=i,this.toastService=o,this.translate=a,this.router=r,this.mileageService=s,this.userData="",this.idMileage=0,this.nStartMiles=0,this.nEndMiles=0,this.nMileage=0,this.nReimbusement=0,this.mileageRate=.3,this.userZones=[],this.idioma="es",this.validateDate=/^(0?[1-9]|[12][0-9]|3[01])[\-](0[1-9]|1[012])[\-]\d{4}$/,a.setDefaultLang(this.idioma),this.translate.use(this.idioma)}backButton(){this.router.navigate(["/tabs/mileages"])}ionViewDidEnter(){return(0,s.mG)(this,void 0,void 0,function*(){if(localStorage.getItem("userData")){this.userData=JSON.parse(localStorage.getItem("userData"));var e=yield this.loadingCtrl.create({message:"Cargando..."});e.present();let t=new Date;t.getFullYear();var n=t.getMonth();t.getDate(),n=parseFloat(n)+1,this.mileageDate=(new Date).toISOString(),this.expensesService.GET_userRegions(this.userData.userID).subscribe(n=>{if("200"!=n[0].statusID)return this.regionsBDArray=[],this.toastService.showToastBottom(n[0].statusDescription),void e.dismiss();this.regionsBDArray=n,this.regionID=n[0].regionID,this.regionName=n[0].regionName}),this.expensesService.GET_userZones(this.userData.userID).subscribe(n=>{if("200"!=n[0].statusID)return this.zonesBDArray=[],this.toastService.showToastBottom(n[0].statusDescription),void e.dismiss();this.zonesBDArray=n,this.zoneID=n[0].zoneID,this.zoneName=n[0].zoneName}),this.mileageRate=this.userData.userMileageRate,e.dismiss()}else this.router.navigate(["/login"])})}calcularValores(){this.nStartMiles>0&&this.nEndMiles>0&&(this.nMileage=this.nEndMiles-this.nStartMiles,this.nReimbusement=Math.round(this.nMileage*this.mileageRate))}transformDate(){var e=this.mileageDate;return e.length>10&&(e=e.substr(0,10)),new Array,e.split("/"),console.log(this.datePipe.transform(e,"dd-MM-yyyy")),this.datePipe.transform(e,"dd-MM-yyyy")}userRegionsModal(){return(0,s.mG)(this,void 0,void 0,function*(){const e=[];for(let n of this.regionsBDArray)e.push(null!=this.regionIDPreference?n.regionID==this.regionIDPreference?{type:"radio",label:n.regionName,value:n.regionID,checked:!0}:{type:"radio",label:n.regionName,value:n.regionID,checked:!1}:n.regionID==this.regionID?{type:"radio",label:n.regionName,value:n.regionID,checked:!0}:{type:"radio",label:n.regionName,value:n.regionID,checked:!1});(yield this.alertCtrl.create({header:this.translate.instant("PAGES.NUEVOGASTO.REGION"),inputs:e,buttons:[{text:this.translate.instant("PAGES.NUEVOGASTO.CANCELAR"),role:"cancel"},{text:"Ok",handler:e=>{this.regionID=e;for(let n of this.regionsBDArray)n.regionID==this.regionID&&(this.regionName=n.regionName)}}]})).present()})}userZonesModal(){return(0,s.mG)(this,void 0,void 0,function*(){const e=[];for(let n of this.zonesBDArray)e.push(null!=this.zoneIDPreference?n.zoneID==this.zoneIDPreference?{type:"radio",label:n.zoneName,value:n.zoneID,checked:!0}:{type:"radio",label:n.zoneName,value:n.zoneID,checked:!1}:n.zoneID==this.zoneID?{type:"radio",label:n.zoneName,value:n.zoneID,checked:!0}:{type:"radio",label:n.zoneName,value:n.zoneID,checked:!1});(yield this.alertCtrl.create({header:this.translate.instant("PAGES.NUEVOGASTO.ZONA"),inputs:e,buttons:[{text:this.translate.instant("PAGES.NUEVOGASTO.CANCELAR"),role:"cancel"},{text:"Ok",handler:e=>{this.zoneID=e;for(let n of this.zonesBDArray)n.zoneID==this.zoneID&&(this.zoneName=n.zoneName)}}]})).present()})}validateDateFunction(e){return!(!this.validateDate.test(e)||""==e)}sendForm(e){return(0,s.mG)(this,void 0,void 0,function*(){if("true"==localStorage.getItem("appNetworkStatus"))if(this.validateDateFunction(this.transformDate())){var n=yield this.loadingCtrl.create({message:"Please wait..."});n.present(),this.mileageService.guardarMileage(e.value,this.userData.userID).subscribe(e=>(0,s.mG)(this,void 0,void 0,function*(){n.dismiss(),(yield this.alertCtrl.create({header:this.translate.instant("PAGES.MILEAGE.MILEAGECREADO"),subHeader:this.translate.instant("PAGES.MILEAGE.MILEAGECREADODESC"),buttons:[{text:"Ok",handler:()=>{this.router.navigate(["/tabs/mileages"])}}]})).present()}),e=>{n.dismiss(),this.toastService.showToastBottom(e)})}else this.toastService.showToastBottom("Formato de fecha invalido (dd-MM-yyyy)");else this.toastService.showToastBottom("Es necesario conectarse a internet")})}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)(l.Y36(i.uU),l.Y36(a.HT),l.Y36(a.Br),l.Y36(g.r),l.Y36(d.k),l.Y36(u.sK),l.Y36(r.F0),l.Y36(c.A))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-new-mileage"]],decls:80,vars:54,consts:[["color","primary","mode","ios"],["icon","arrow-back","text","","defaultHref","../gastos",3,"click"],["padding",""],[3,"ngSubmit"],["forma","ngForm"],["size","12"],["position","stacked"],["type","hidden","name","idMileage","readonly","true","value","0",3,"ngModel","ngModelChange"],["displayFormat","MM/DD/YYYY","name","mileageDate","required","",3,"ngModel","ngModelChange","ionChange"],["size","6","no-padding",""],["type","text","name","regionName","readonly","true","required","",3,"ngModel","click","ngModelChange"],[2,"display","none"],["type","text","name","regionID","readonly","true","required","",3,"ngModel","click","ngModelChange"],["type","text","name","zoneName","readonly","true","required","",3,"ngModel","click","ngModelChange"],["type","text","name","zoneID","readonly","true","required","",3,"ngModel","click","ngModelChange"],["type","text","name","sStart","required","",3,"ngModel","ngModelChange"],["type","text","name","sDestination","required","",3,"ngModel","ngModelChange"],["type","text","name","sDescription","required","",3,"ngModel","ngModelChange"],["type","number","name","nStartMiles","required","",3,"ngModel","ngModelChange","ionChange"],["type","number","name","nEndMiles","required","",3,"ngModel","ngModelChange","ionChange"],["type","number","name","nMileage","readonly","true","required","",3,"ngModel","ngModelChange"],["type","number","name","nReimbusement","readonly","true","required","",3,"ngModel","ngModelChange"],["rows","3","maxLength","100","name","sGeneralcomments",3,"ngModel","ngModelChange"],["type","submit","expand","block","color","primary",3,"disabled"]],template:function(e,n){if(1&e){const e=l.EpF();l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar",0),l.TgZ(2,"ion-buttons"),l.TgZ(3,"ion-back-button",1),l.NdJ("click",function(){return n.backButton()}),l.qZA(),l.qZA(),l.TgZ(4,"ion-title"),l._uU(5),l.ALo(6,"translate"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(7,"ion-content",2),l.TgZ(8,"form",3,4),l.NdJ("ngSubmit",function(){l.CHM(e);const t=l.MAs(9);return n.sendForm(t)}),l.TgZ(10,"ion-row"),l.TgZ(11,"ion-col",5),l.TgZ(12,"ion-item"),l.TgZ(13,"ion-label",6),l._uU(14),l.ALo(15,"translate"),l.qZA(),l.TgZ(16,"ion-input",7),l.NdJ("ngModelChange",function(e){return n.idMileage=e}),l.qZA(),l.TgZ(17,"ion-datetime",8),l.NdJ("ngModelChange",function(e){return n.mileageDate=e})("ionChange",function(){return n.transformDate()}),l.qZA(),l.qZA(),l.TgZ(18,"ion-col",9),l.TgZ(19,"ion-item"),l.TgZ(20,"ion-label",6),l._uU(21),l.ALo(22,"translate"),l.qZA(),l.TgZ(23,"ion-input",10),l.NdJ("click",function(){return n.userRegionsModal()})("ngModelChange",function(e){return n.regionName=e}),l.qZA(),l.qZA(),l.TgZ(24,"ion-item",11),l.TgZ(25,"ion-label",6),l._uU(26,"ID"),l.qZA(),l.TgZ(27,"ion-input",12),l.NdJ("click",function(){return n.userRegionsModal()})("ngModelChange",function(e){return n.regionID=e}),l.qZA(),l.qZA(),l.qZA(),l.TgZ(28,"ion-item"),l.TgZ(29,"ion-label",6),l._uU(30),l.ALo(31,"translate"),l.qZA(),l.TgZ(32,"ion-input",13),l.NdJ("click",function(){return n.userZonesModal()})("ngModelChange",function(e){return n.zoneName=e}),l.qZA(),l.qZA(),l.TgZ(33,"ion-item",11),l.TgZ(34,"ion-label",6),l._uU(35,"ID"),l.qZA(),l.TgZ(36,"ion-input",14),l.NdJ("click",function(){return n.userZonesModal()})("ngModelChange",function(e){return n.zoneID=e}),l.qZA(),l.qZA(),l.TgZ(37,"ion-item"),l.TgZ(38,"ion-label",6),l._uU(39),l.ALo(40,"translate"),l.qZA(),l.TgZ(41,"ion-input",15),l.NdJ("ngModelChange",function(e){return n.sStart=e}),l.qZA(),l.qZA(),l.TgZ(42,"ion-item"),l.TgZ(43,"ion-label",6),l._uU(44),l.ALo(45,"translate"),l.qZA(),l.TgZ(46,"ion-input",16),l.NdJ("ngModelChange",function(e){return n.sDestination=e}),l.qZA(),l.qZA(),l.TgZ(47,"ion-item"),l.TgZ(48,"ion-label",6),l._uU(49),l.ALo(50,"translate"),l.qZA(),l.TgZ(51,"ion-input",17),l.NdJ("ngModelChange",function(e){return n.sDescription=e}),l.qZA(),l.qZA(),l.TgZ(52,"ion-item"),l.TgZ(53,"ion-label",6),l._uU(54),l.ALo(55,"translate"),l.qZA(),l.TgZ(56,"ion-input",18),l.NdJ("ngModelChange",function(e){return n.nStartMiles=e})("ionChange",function(){return n.calcularValores()}),l.qZA(),l.qZA(),l.TgZ(57,"ion-item"),l.TgZ(58,"ion-label",6),l._uU(59),l.ALo(60,"translate"),l.qZA(),l.TgZ(61,"ion-input",19),l.NdJ("ngModelChange",function(e){return n.nEndMiles=e})("ionChange",function(){return n.calcularValores()}),l.qZA(),l.qZA(),l.TgZ(62,"ion-item"),l.TgZ(63,"ion-label",6),l._uU(64),l.ALo(65,"translate"),l.qZA(),l.TgZ(66,"ion-input",20),l.NdJ("ngModelChange",function(e){return n.nMileage=e}),l.qZA(),l.qZA(),l.TgZ(67,"ion-item"),l.TgZ(68,"ion-label",6),l._uU(69),l.ALo(70,"translate"),l.qZA(),l.TgZ(71,"ion-input",21),l.NdJ("ngModelChange",function(e){return n.nReimbusement=e}),l.qZA(),l.qZA(),l.TgZ(72,"ion-item"),l.TgZ(73,"ion-label",6),l._uU(74),l.ALo(75,"translate"),l.qZA(),l.TgZ(76,"ion-textarea",22),l.NdJ("ngModelChange",function(e){return n.sGeneralcomments=e}),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(77,"ion-button",23),l._uU(78),l.ALo(79,"translate"),l.qZA(),l.qZA(),l.qZA()}if(2&e){const e=l.MAs(9);l.xp6(5),l.Oqu(l.lcZ(6,28,"PAGES.MILEAGE.NEWMILEAGE")),l.xp6(9),l.hij("",l.lcZ(15,30,"PAGES.MILEAGE.DATE"),"*"),l.xp6(2),l.Q6J("ngModel",n.idMileage),l.xp6(1),l.Q6J("ngModel",n.mileageDate),l.xp6(4),l.hij("",l.lcZ(22,32,"PAGES.NUEVOGASTO.REGION"),"*"),l.xp6(2),l.Q6J("ngModel",n.regionName),l.xp6(4),l.Q6J("ngModel",n.regionID),l.xp6(3),l.hij("",l.lcZ(31,34,"PAGES.NUEVOGASTO.ZONA"),"*"),l.xp6(2),l.Q6J("ngModel",n.zoneName),l.xp6(4),l.Q6J("ngModel",n.zoneID),l.xp6(3),l.hij("",l.lcZ(40,36,"PAGES.MILEAGE.START"),"*"),l.xp6(2),l.Q6J("ngModel",n.sStart),l.xp6(3),l.hij("",l.lcZ(45,38,"PAGES.MILEAGE.DESTINATION"),"*"),l.xp6(2),l.Q6J("ngModel",n.sDestination),l.xp6(3),l.hij("",l.lcZ(50,40,"PAGES.MILEAGE.DESCRIPTION"),"*"),l.xp6(2),l.Q6J("ngModel",n.sDescription),l.xp6(3),l.hij("",l.lcZ(55,42,"PAGES.MILEAGE.STARTMILES"),"*"),l.xp6(2),l.Q6J("ngModel",n.nStartMiles),l.xp6(3),l.hij("",l.lcZ(60,44,"PAGES.MILEAGE.ENDMILES"),"*"),l.xp6(2),l.Q6J("ngModel",n.nEndMiles),l.xp6(3),l.hij("",l.lcZ(65,46,"PAGES.MILEAGE.MILEAGE"),"*"),l.xp6(2),l.Q6J("ngModel",n.nMileage),l.xp6(3),l.hij("",l.lcZ(70,48,"PAGES.MILEAGE.REIMBUSEMENT"),"*"),l.xp6(2),l.Q6J("ngModel",n.nReimbusement),l.xp6(3),l.Oqu(l.lcZ(75,50,"PAGES.MILEAGE.GENERALCOMMENTS")),l.xp6(2),l.Q6J("ngModel",n.sGeneralcomments),l.xp6(1),l.Q6J("disabled",!e.valid),l.xp6(1),l.hij("",l.lcZ(79,52,"PAGES.NUEVOGASTO.ENVIAR")," ")}},directives:[a.Gu,a.sr,a.Sm,a.oU,a.cs,a.wd,a.W2,o._Y,o.JL,o.F,a.Nd,a.wI,a.Ie,a.Q$,a.pK,a.j9,o.JJ,o.On,a.x4,a.QI,o.Q7,a.as,a.g2,a.YG],pipes:[u.X$],styles:["ion-content[_ngcontent-%COMP%]{--padding-end:10px;--padding-top:10px}"]}),e})()}];let m=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[r.Bz.forChild(h)],r.Bz]}),e})();var A=t(9037),M=t(2693);function Z(e){return new A.w(e,"assets/i18n/",".json")}let p=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[i.ez,o.u5,a.Pc,m,u.aw.forRoot({loader:{provide:u.Zw,useFactory:Z,deps:[M.eN]}})]]}),e})()}}]);