(self.webpackChunkMyInnovak=self.webpackChunkMyInnovak||[]).push([[7079],{7079:(e,t,n)=>{"use strict";n.r(t),n.d(t,{HttpLoaderFactory:()=>Z,MileagePageModule:()=>D});var i=n(1116),a=n(1041),o=n(4812),s=n(4258),r=n(4762),l=n(5366),g=n(6171),d=n(7047),u=n(649),h=n(4216);const c=[{path:"",component:(()=>{class e{constructor(e,t,n,i,a,o,s,r){this.datePipe=e,this.loadingCtrl=t,this.alertCtrl=n,this.expensesService=i,this.toastService=a,this.translate=o,this.router=s,this.mileageService=r,this.userData="",this.idMileage=0,this.nStartMiles=0,this.nEndMiles=0,this.nMileage=0,this.nReimbusement=0,this.mileageRate=.3,this.userZones=[],this.idioma="es",this.validateDate=/^(0?[1-9]|[12][0-9]|3[01])[\-](0[1-9]|1[012])[\-]\d{4}$/,o.setDefaultLang(this.idioma),this.translate.use(this.idioma);const l=this.router.getCurrentNavigation();this.idMileage=l.extras.state.mileage}backButton(){this.router.navigate(["/tabs/mileages"])}ionViewDidEnter(){return(0,r.mG)(this,void 0,void 0,function*(){if(localStorage.getItem("userData")){this.userData=JSON.parse(localStorage.getItem("userData"));var e=yield this.loadingCtrl.create({message:"Cargando..."});e.present();let n=new Date;n.getFullYear();var t=n.getMonth();n.getDate(),t=parseFloat(t)+1,this.mileageDate=(new Date).toISOString(),this.expensesService.GET_userRegions(this.userData.userID).subscribe(t=>{if("200"!=t[0].statusID)return this.regionsBDArray=[],this.toastService.showToastBottom(t[0].statusDescription),void e.dismiss();this.regionsBDArray=t,this.regionID=t[0].regionID,this.regionName=t[0].regionName}),this.expensesService.GET_userZones(this.userData.userID).subscribe(t=>{if("200"!=t[0].statusID)return this.zonesBDArray=[],this.toastService.showToastBottom(t[0].statusDescription),void e.dismiss();this.zonesBDArray=t,this.zoneID=t[0].zoneID,this.zoneName=t[0].zoneName}),this.mileageService.GET_userMileage(this.idMileage).subscribe(e=>{this.idMileage=e[0].IdMileage;var t=e[0].Fecha.substr(0,10),n=new Array;n=t.split("/");var i=new Date(Date.UTC(n[2],n[1]-1,n[0],0,0,0));this.mileageDate=i.toISOString(),this.sStart=e[0].Origen,this.sDestination=e[0].Destino,this.sDescription=e[0].Descripcion,this.nStartMiles=e[0].MillasIniciales,this.nEndMiles=e[0].MillasFin,this.nMileage=e[0].nMileage,this.nReimbusement=e[0].Reembolso,this.sGeneralcomments=e[0].Comentarios,this.regionID=e[0].IdRegion,this.zoneID=e[0].IdZona,this.zoneName=e[0].Zona,this.mileageStatus=e[0].mileageStatus,this.mileageStatusName=e[0].mileageStatusName}),this.mileageRate=this.userData.userMileageRate,e.dismiss()}else this.router.navigate(["/login"])})}calcularValores(){this.nStartMiles>0&&this.nEndMiles>0&&(this.nMileage=this.nEndMiles-this.nStartMiles,this.nReimbusement=Math.round(this.nMileage*this.mileageRate))}transformDate(){var e=this.mileageDate;return e.length>10&&(e=e.substr(0,10)),new Array,e.split("/"),console.log(this.datePipe.transform(e,"dd-MM-yyyy")),this.datePipe.transform(e,"dd-MM-yyyy")}userRegionsModal(){return(0,r.mG)(this,void 0,void 0,function*(){const e=[];for(let t of this.regionsBDArray)e.push(null!=this.regionIDPreference?t.regionID==this.regionIDPreference?{type:"radio",label:t.regionName,value:t.regionID,checked:!0}:{type:"radio",label:t.regionName,value:t.regionID,checked:!1}:t.regionID==this.regionID?{type:"radio",label:t.regionName,value:t.regionID,checked:!0}:{type:"radio",label:t.regionName,value:t.regionID,checked:!1});(yield this.alertCtrl.create({header:this.translate.instant("PAGES.NUEVOGASTO.REGION"),inputs:e,buttons:[{text:this.translate.instant("PAGES.NUEVOGASTO.CANCELAR"),role:"cancel"},{text:"Ok",handler:e=>{this.regionID=e;for(let t of this.regionsBDArray)t.regionID==this.regionID&&(this.regionName=t.regionName)}}]})).present()})}userZonesModal(){return(0,r.mG)(this,void 0,void 0,function*(){const e=[];for(let t of this.zonesBDArray)e.push(null!=this.zoneIDPreference?t.zoneID==this.zoneIDPreference?{type:"radio",label:t.zoneName,value:t.zoneID,checked:!0}:{type:"radio",label:t.zoneName,value:t.zoneID,checked:!1}:t.zoneID==this.zoneID?{type:"radio",label:t.zoneName,value:t.zoneID,checked:!0}:{type:"radio",label:t.zoneName,value:t.zoneID,checked:!1});(yield this.alertCtrl.create({header:this.translate.instant("PAGES.NUEVOGASTO.ZONA"),inputs:e,buttons:[{text:this.translate.instant("PAGES.NUEVOGASTO.CANCELAR"),role:"cancel"},{text:"Ok",handler:e=>{this.zoneID=e;for(let t of this.zonesBDArray)t.zoneID==this.zoneID&&(this.zoneName=t.zoneName)}}]})).present()})}validateDateFunction(e){return!(!this.validateDate.test(e)||""==e)}sendForm(e){return(0,r.mG)(this,void 0,void 0,function*(){if("true"==localStorage.getItem("appNetworkStatus"))if(this.validateDateFunction(this.transformDate())){var t=yield this.loadingCtrl.create({message:"Please wait..."});t.present(),this.mileageService.guardarMileage(e.value,this.userData.userID).subscribe(e=>(0,r.mG)(this,void 0,void 0,function*(){t.dismiss(),(yield this.alertCtrl.create({header:this.translate.instant("PAGES.MILEAGE.MILEAGECREADO"),subHeader:this.translate.instant("PAGES.MILEAGE.MILEAGECREADODESC"),buttons:[{text:"Ok",handler:()=>{this.router.navigate(["/tabs/mileages"])}}]})).present()}),e=>{t.dismiss(),this.toastService.showToastBottom(e)})}else this.toastService.showToastBottom("Formato de fecha invalido (dd-MM-yyyy)");else this.toastService.showToastBottom("Es necesario conectarse a internet")})}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(i.uU),l.Y36(o.HT),l.Y36(o.Br),l.Y36(g.r),l.Y36(d.k),l.Y36(u.sK),l.Y36(s.F0),l.Y36(h.A))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-mileage"]],features:[l._Bn([o.X1])],decls:79,vars:52,consts:[["color","primary","mode","ios"],["icon","arrow-back","text","","defaultHref","../gastos",3,"click"],["padding",""],[3,"ngSubmit"],["forma","ngForm"],["size","12"],["position","stacked"],["type","hidden","name","idMileage","readonly","true","value","0",3,"ngModel","ngModelChange"],["displayFormat","MM/DD/YYYY","name","mileageDate","required","",3,"ngModel","ngModelChange","ionChange"],["size","6","no-padding",""],["type","text","name","regionName","readonly","true","required","",3,"ngModel","click","ngModelChange"],[2,"display","none"],["type","text","name","regionID","readonly","true","required","",3,"ngModel","click","ngModelChange"],["type","text","name","zoneName","readonly","true","required","",3,"ngModel","click","ngModelChange"],["type","text","name","zoneID","readonly","true","required","",3,"ngModel","click","ngModelChange"],["type","text","name","sStart","required","",3,"ngModel","ngModelChange"],["type","text","name","sDestination","required","",3,"ngModel","ngModelChange"],["type","text","name","sDescription","required","",3,"ngModel","ngModelChange"],["type","number","name","nStartMiles","required","",3,"ngModel","ngModelChange","ionChange"],["type","number","name","nEndMiles","required","",3,"ngModel","ngModelChange","ionChange"],["type","number","name","nMileage","readonly","true","required","",3,"ngModel","ngModelChange"],["type","number","name","nReimbusement","readonly","true","required","",3,"ngModel","ngModelChange"],["rows","3","maxLength","100","name","sGeneralcomments",3,"ngModel","ngModelChange"],["type","submit","expand","block","color","primary",3,"disabled"]],template:function(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar",0),l.TgZ(2,"ion-buttons"),l.TgZ(3,"ion-back-button",1),l.NdJ("click",function(){return t.backButton()}),l.qZA(),l.qZA(),l.TgZ(4,"ion-title"),l._uU(5),l.qZA(),l.qZA(),l.qZA(),l.TgZ(6,"ion-content",2),l.TgZ(7,"form",3,4),l.NdJ("ngSubmit",function(){l.CHM(e);const n=l.MAs(8);return t.sendForm(n)}),l.TgZ(9,"ion-row"),l.TgZ(10,"ion-col",5),l.TgZ(11,"ion-item"),l.TgZ(12,"ion-label",6),l._uU(13),l.ALo(14,"translate"),l.qZA(),l.TgZ(15,"ion-input",7),l.NdJ("ngModelChange",function(e){return t.idMileage=e}),l.qZA(),l.TgZ(16,"ion-datetime",8),l.NdJ("ngModelChange",function(e){return t.mileageDate=e})("ionChange",function(){return t.transformDate()}),l.qZA(),l.qZA(),l.TgZ(17,"ion-col",9),l.TgZ(18,"ion-item"),l.TgZ(19,"ion-label",6),l._uU(20),l.ALo(21,"translate"),l.qZA(),l.TgZ(22,"ion-input",10),l.NdJ("click",function(){return t.userRegionsModal()})("ngModelChange",function(e){return t.regionName=e}),l.qZA(),l.qZA(),l.TgZ(23,"ion-item",11),l.TgZ(24,"ion-label",6),l._uU(25,"ID"),l.qZA(),l.TgZ(26,"ion-input",12),l.NdJ("click",function(){return t.userRegionsModal()})("ngModelChange",function(e){return t.regionID=e}),l.qZA(),l.qZA(),l.qZA(),l.TgZ(27,"ion-item"),l.TgZ(28,"ion-label",6),l._uU(29),l.ALo(30,"translate"),l.qZA(),l.TgZ(31,"ion-input",13),l.NdJ("click",function(){return t.userZonesModal()})("ngModelChange",function(e){return t.zoneName=e}),l.qZA(),l.qZA(),l.TgZ(32,"ion-item",11),l.TgZ(33,"ion-label",6),l._uU(34,"ID"),l.qZA(),l.TgZ(35,"ion-input",14),l.NdJ("click",function(){return t.userZonesModal()})("ngModelChange",function(e){return t.zoneID=e}),l.qZA(),l.qZA(),l.TgZ(36,"ion-item"),l.TgZ(37,"ion-label",6),l._uU(38),l.ALo(39,"translate"),l.qZA(),l.TgZ(40,"ion-input",15),l.NdJ("ngModelChange",function(e){return t.sStart=e}),l.qZA(),l.qZA(),l.TgZ(41,"ion-item"),l.TgZ(42,"ion-label",6),l._uU(43),l.ALo(44,"translate"),l.qZA(),l.TgZ(45,"ion-input",16),l.NdJ("ngModelChange",function(e){return t.sDestination=e}),l.qZA(),l.qZA(),l.TgZ(46,"ion-item"),l.TgZ(47,"ion-label",6),l._uU(48),l.ALo(49,"translate"),l.qZA(),l.TgZ(50,"ion-input",17),l.NdJ("ngModelChange",function(e){return t.sDescription=e}),l.qZA(),l.qZA(),l.TgZ(51,"ion-item"),l.TgZ(52,"ion-label",6),l._uU(53),l.ALo(54,"translate"),l.qZA(),l.TgZ(55,"ion-input",18),l.NdJ("ngModelChange",function(e){return t.nStartMiles=e})("ionChange",function(){return t.calcularValores()}),l.qZA(),l.qZA(),l.TgZ(56,"ion-item"),l.TgZ(57,"ion-label",6),l._uU(58),l.ALo(59,"translate"),l.qZA(),l.TgZ(60,"ion-input",19),l.NdJ("ngModelChange",function(e){return t.nEndMiles=e})("ionChange",function(){return t.calcularValores()}),l.qZA(),l.qZA(),l.TgZ(61,"ion-item"),l.TgZ(62,"ion-label",6),l._uU(63),l.ALo(64,"translate"),l.qZA(),l.TgZ(65,"ion-input",20),l.NdJ("ngModelChange",function(e){return t.nMileage=e}),l.qZA(),l.qZA(),l.TgZ(66,"ion-item"),l.TgZ(67,"ion-label",6),l._uU(68),l.ALo(69,"translate"),l.qZA(),l.TgZ(70,"ion-input",21),l.NdJ("ngModelChange",function(e){return t.nReimbusement=e}),l.qZA(),l.qZA(),l.TgZ(71,"ion-item"),l.TgZ(72,"ion-label",6),l._uU(73),l.ALo(74,"translate"),l.qZA(),l.TgZ(75,"ion-textarea",22),l.NdJ("ngModelChange",function(e){return t.sGeneralcomments=e}),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(76,"ion-button",23),l._uU(77),l.ALo(78,"translate"),l.qZA(),l.qZA(),l.qZA()}if(2&e){const e=l.MAs(8);l.xp6(5),l.hij("Mileage #",t.idMileage,""),l.xp6(8),l.hij("",l.lcZ(14,28,"PAGES.MILEAGE.DATE"),"*"),l.xp6(2),l.Q6J("ngModel",t.idMileage),l.xp6(1),l.Q6J("ngModel",t.mileageDate),l.xp6(4),l.hij("",l.lcZ(21,30,"PAGES.NUEVOGASTO.REGION"),"*"),l.xp6(2),l.Q6J("ngModel",t.regionName),l.xp6(4),l.Q6J("ngModel",t.regionID),l.xp6(3),l.hij("",l.lcZ(30,32,"PAGES.NUEVOGASTO.ZONA"),"*"),l.xp6(2),l.Q6J("ngModel",t.zoneName),l.xp6(4),l.Q6J("ngModel",t.zoneID),l.xp6(3),l.hij("",l.lcZ(39,34,"PAGES.MILEAGE.START"),"*"),l.xp6(2),l.Q6J("ngModel",t.sStart),l.xp6(3),l.hij("",l.lcZ(44,36,"PAGES.MILEAGE.DESTINATION"),"*"),l.xp6(2),l.Q6J("ngModel",t.sDestination),l.xp6(3),l.hij("",l.lcZ(49,38,"PAGES.MILEAGE.DESCRIPTION"),"*"),l.xp6(2),l.Q6J("ngModel",t.sDescription),l.xp6(3),l.hij("",l.lcZ(54,40,"PAGES.MILEAGE.STARTMILES"),"*"),l.xp6(2),l.Q6J("ngModel",t.nStartMiles),l.xp6(3),l.hij("",l.lcZ(59,42,"PAGES.MILEAGE.ENDMILES"),"*"),l.xp6(2),l.Q6J("ngModel",t.nEndMiles),l.xp6(3),l.hij("",l.lcZ(64,44,"PAGES.MILEAGE.MILEAGE"),"*"),l.xp6(2),l.Q6J("ngModel",t.nMileage),l.xp6(3),l.hij("",l.lcZ(69,46,"PAGES.MILEAGE.REIMBUSEMENT"),"*"),l.xp6(2),l.Q6J("ngModel",t.nReimbusement),l.xp6(3),l.Oqu(l.lcZ(74,48,"PAGES.MILEAGE.GENERALCOMMENTS")),l.xp6(2),l.Q6J("ngModel",t.sGeneralcomments),l.xp6(1),l.Q6J("disabled",!e.valid),l.xp6(1),l.hij("",l.lcZ(78,50,"PAGES.NUEVOGASTO.ENVIAR")," ")}},directives:[o.Gu,o.sr,o.Sm,o.oU,o.cs,o.wd,o.W2,a._Y,a.JL,a.F,o.Nd,o.wI,o.Ie,o.Q$,o.pK,o.j9,a.JJ,a.On,o.x4,o.QI,a.Q7,o.as,o.g2,o.YG],pipes:[u.X$],styles:["ion-content[_ngcontent-%COMP%]{--padding-end:10px;--padding-top:10px}"]}),e})()}];let m=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[s.Bz.forChild(c)],s.Bz]}),e})();var M=n(9037),A=n(2693),p=n(5774);function Z(e){return new M.w(e,"assets/i18n/",".json")}let D=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[i.ez,a.u5,o.Pc,m,p.D,u.aw.forRoot({loader:{provide:u.Zw,useFactory:Z,deps:[A.eN]}})]]}),e})()}}]);